const $=e=>document.getElementById(e),CFG={types:["PHOTO","PLAN","MEET","REGISTER","BORING","SURVEY","DRAWING","SPEC","OTHRS"],names:["å†™çœŸ","è¨ˆç”»","æ‰“åˆ","å°å¸³","èª¿æŸ»","æ¸¬é‡","å›³é¢","ä»•æ§˜","ãã®ä»–"],icons:["ğŸ“·","ğŸ“‹","ğŸ“","ğŸ“Š","ğŸ”","ğŸ“","ğŸ“","ğŸ“–","ğŸ“"],patterns:[/\.(jpe?g|png|gif)$/i,/\.(pdf|docx?|xlsx?)$/i,/\.(pdf|docx?)$/i,/\.(pdf|xlsx?|csv)$/i,/\.(pdf|xlsx?)$/i,/\.(pdf|dwg|dxf)$/i,/\.(dwg|dxf|pdf)$/i,/\.(pdf|docx?)$/i,/\.(pdf|docx?|xlsx?|dwg|dxf)$/i],spec:{PHOTO:{s:"å†™çœŸæƒ…å ±",f:"å†™çœŸãƒ•ã‚¡ã‚¤ãƒ«å",j:"",fields:{title:"å†™çœŸã‚¿ã‚¤ãƒˆãƒ«",date:"æ’®å½±å¹´æœˆæ—¥",serial:"ã‚·ãƒªã‚¢ãƒ«ç•ªå·",media:"ãƒ¡ãƒ‡ã‚£ã‚¢ç•ªå·",category:"å†™çœŸ-å¤§åˆ†é¡",division:"å†™çœŸåŒºåˆ†",representative:"ä»£è¡¨å†™çœŸ",frequency:"æå‡ºé »åº¦å†™çœŸ"}},PLAN:{s:"æ–½å·¥è¨ˆç”»æ›¸æƒ…å ±",f:"æ–½å·¥è¨ˆç”»æ›¸ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å",j:"æ–½å·¥è¨ˆç”»æ›¸ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æ—¥æœ¬èªå",fields:{title:"æ–½å·¥è¨ˆç”»æ›¸åç§°",date:"ä½œæˆå¹´æœˆæ—¥",serial:"ã‚·ãƒªã‚¢ãƒ«ç•ªå·"}},MEET:{s:"æ‰“åˆã›ç°¿æƒ…å ±",f:"æ‰“åˆã›ç°¿ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å",j:"æ‰“åˆã›ç°¿ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æ—¥æœ¬èªå",fields:{title:"æ‰“åˆã›ç°¿åç§°",date:"ç™ºè¡Œæ—¥ä»˜",serial:"ã‚·ãƒªã‚¢ãƒ«ç•ªå·"}},REGISTER:{s:"å°å¸³æƒ…å ±",f:"å°å¸³ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å",j:"å°å¸³ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æ—¥æœ¬èªå",fields:{title:"å°å¸³å",date:"ä½œæˆå¹´æœˆæ—¥",serial:"ã‚·ãƒªã‚¢ãƒ«ç•ªå·"}},BORING:{s:"åœ°è³ªèª¿æŸ»æƒ…å ±",f:"åœ°è³ªèª¿æŸ»ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å",j:"åœ°è³ªèª¿æŸ»ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æ—¥æœ¬èªå",fields:{title:"èª¿æŸ»å",date:"èª¿æŸ»å¹´æœˆæ—¥",serial:"ã‚·ãƒªã‚¢ãƒ«ç•ªå·"}},SURVEY:{s:"æ¸¬é‡æƒ…å ±",f:"æ¸¬é‡ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å",j:"æ¸¬é‡ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æ—¥æœ¬èªå",fields:{title:"æ¸¬é‡å",date:"æ¸¬é‡å¹´æœˆæ—¥",serial:"ã‚·ãƒªã‚¢ãƒ«ç•ªå·"}},DRAWING:{s:"å›³é¢æƒ…å ±",f:"å›³é¢ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å",j:"å›³é¢ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æ—¥æœ¬èªå",fields:{title:"å›³é¢å",date:"ä½œæˆå¹´æœˆæ—¥",serial:"ã‚·ãƒªã‚¢ãƒ«ç•ªå·"}},SPEC:{s:"ä»•æ§˜æ›¸æƒ…å ±",f:"ä»•æ§˜æ›¸ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å",j:"ä»•æ§˜æ›¸ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æ—¥æœ¬èªå",fields:{title:"ä»•æ§˜æ›¸å",date:"ä½œæˆå¹´æœˆæ—¥",serial:"ã‚·ãƒªã‚¢ãƒ«ç•ªå·"}},OTHRS:{s:"ãã®ä»–è³‡æ–™æƒ…å ±",f:"ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å",j:"ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æ—¥æœ¬èªå",fields:{title:"è³‡æ–™å",date:"",serial:"ã‚·ãƒªã‚¢ãƒ«ç•ªå·"}}}};class XMLViewer{constructor(){this.M=new Map,this.X=new Map,this.U=new Map,this.F=new Map,this.P=[],this.I=0,this.R=null,this.E=new Set,this.photoData=new Map,this.init()}init(){const e=$("u"),t=$("i");["dragenter","dragover","dragleave","drop"].forEach((t,s)=>e.addEventListener(t,t=>{t.preventDefault(),t.stopPropagation(),e.classList[s<2?"add":"remove"]("d")})),e.addEventListener("drop",e=>this.handleFiles([...e.dataTransfer.files])),t.addEventListener("change",e=>this.handleFiles([...e.target.files])),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.closeModal(),$("mo").classList.contains("sh")&&("ArrowLeft"===e.key&&this.prevPhoto(),"ArrowRight"===e.key&&this.nextPhoto())})}async handleFiles(e){if(e.length)try{this.progress(0,"åé›†"),this.clear();const t=[];e.forEach(e=>{const s=(e.webkitRelativePath||e.name).toUpperCase();if(this.M.set(s,e),s.endsWith(".XML"))if(s.includes("INDEX_C.XML"))t.unshift({file:e,type:"INDEX",path:s});else if(s.includes("OTHRS.XML"))t.push({file:e,type:"OTHRS",path:s});else{const i=CFG.types.find(e=>s.includes(e+"/"));i&&t.push({file:e,type:i,path:s})}}),this.progress(25,"è§£æ"),await Promise.all(t.map(({file:e,type:t})=>this.readXML(e,t))),this.progress(60,"åˆ†é¡"),this.categorize(),this.progress(85,"æ§‹ç¯‰"),this.buildTree(),this.hideProgress(),$("u").style.display="none",$("t").style.display="block",$("hs").textContent=`${this.F.size}åˆ†é¡ã€${this.M.size}ãƒ•ã‚¡ã‚¤ãƒ«`,this.updateProjectHeader()}catch(e){this.hideProgress(),this.error("ã‚¨ãƒ©ãƒ¼ï¼š"+e.message)}}async readXML(e,t){try{if("INDEX"===t)return void await this.readIndexXML(e);if("OTHRS"===t)return void await this.readOthrsXML(e);const s=CFG.spec[t];if(!s)return;let i=await this.readText(e,"UTF-8");(i.includes("ï¿½")||!/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(i)||/encoding=["'](?:shift[-_]?jis|sjis|windows-31j)/i.test(i))&&(i=await this.readText(e,"Shift_JIS"));const a=(new DOMParser).parseFromString(i,"text/xml");if(a.querySelector("parsererror"))return;a.querySelectorAll(s.s).forEach(e=>{const i=e.querySelectorAll("ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±");if(i.length>0)i.forEach(i=>{const a=this.getTag(i,s.f),o=s.j?this.getTag(i,s.j):null;a&&this.processXMLItem(e,a,t,s,o)});else{const i=this.getTag(e,s.f);i&&this.processXMLItem(e,i,t,s)}})}catch(t){console.warn("XMLè§£æã‚¨ãƒ©ãƒ¼:",e.name,t)}}async readOthrsXML(e){try{let t=await this.readText(e,"UTF-8");(t.includes("ï¿½")||!/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(t)||/encoding=["'](?:shift[-_]?jis|sjis|windows-31j)/i.test(t))&&(t=await this.readText(e,"Shift_JIS"));const s=(new DOMParser).parseFromString(t,"text/xml");if(s.querySelector("parsererror"))return;s.querySelectorAll("ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€æƒ…å ±").forEach(e=>{const t=this.getTag(e,"ãã®ä»–ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€æ—¥æœ¬èªå");e.querySelectorAll("ãã®ä»–è³‡æ–™æƒ…å ±").forEach(e=>{const s=e.querySelector("ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±");if(s){const i=this.getTag(s,"ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å"),a=this.getTag(s,"ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«æ—¥æœ¬èªå"),o=this.getTag(e,"è³‡æ–™å"),r=this.getTag(s,"ã‚·ãƒªã‚¢ãƒ«ç•ªå·");if(i){const e={filename:i,type:"OTHRS",title:o||t,serial:r,japaneseName:a,folder:t};[i,i.toUpperCase(),i.toLowerCase()].forEach(t=>{this.X.has(t)||this.X.set(t,e)})}}})})}catch(e){console.warn("OTHRS.XMLè§£æã‚¨ãƒ©ãƒ¼:",e)}}async readIndexXML(e){try{let t=await this.readText(e,"UTF-8");(t.includes("ï¿½")||!/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(t)||/encoding=["'](?:shift[-_]?jis|sjis|windows-31j)/i.test(t))&&(t=await this.readText(e,"Shift_JIS"));const s=(new DOMParser).parseFromString(t,"text/xml");if(s.querySelector("parsererror"))return;this.R={name:this.getTag(s,"å·¥äº‹ä»¶å"),type:this.getTag(s,"å·¥ç¨®-å·¥æ³•å½¢å¼"),content:this.getTag(s,"å·¥äº‹å†…å®¹"),startDate:this.formatDate(this.getTag(s,"å·¥æœŸé–‹å§‹æ—¥")),endDate:this.formatDate(this.getTag(s,"å·¥æœŸçµ‚äº†æ—¥")),contractor:this.getTag(s,"è«‹è² æ¥­è€…å")}}catch(e){console.warn("INDEX_C.XMLè§£æã‚¨ãƒ©ãƒ¼:",e)}}formatDate(e){if(!e)return"";const t=e.match(/(\d{4})(\d{2})(\d{2})/);return t?`${t[1]}/${t[2]}/${t[3]}`:e}processXMLItem(e,t,s,i,a){if(!t)return;const o={filename:t,type:s};a&&(o.japaneseName=a),Object.entries(i.fields).forEach(([t,s])=>{const i=this.getTag(e,s);i&&(o[t]="ä»£è¡¨å†™çœŸ"===s||"æå‡ºé »åº¦å†™çœŸ"===s?"1"===i:i)}),[t,t.toUpperCase(),t.toLowerCase()].forEach(e=>{this.X.has(e)||this.X.set(e,o)})}readText(e,t="UTF-8"){return new Promise((s,i)=>{const a=new FileReader;a.onload=e=>s(e.target.result),a.onerror=i,a.readAsText(e,t)})}getTag(e,t){const s=e?.querySelector(t);return s?s.textContent.trim():""}categorize(){CFG.types.forEach((e,t)=>{const s=this.filterFiles(e,CFG.patterns[t]);s.length>0&&("PHOTO"===e?this.categorizePhotos(s):"OTHRS"===e?this.categorizeOthrs(s):this.categorizeNonPhoto(e,s))})}filterFiles(e,t){const s=[];for(let[i,a]of this.M)if((i.includes(e+"/")||i.includes(e))&&!i.endsWith(".XML")&&!i.endsWith(".DTD")&&t.test(i)){const e=i.split("/").pop();s.push({name:e,file:a,path:i,ext:e.split(".").pop().toLowerCase()})}return s}categorizePhotos(e){const t=new Map;e.forEach(e=>{const s=e.name,i=this.X.get(s)||this.X.get(s.toUpperCase())||this.X.get(s.toLowerCase())||{category:"æœªåˆ†é¡",division:"ãã®ä»–",title:s,filename:s},a=i.category||"æœªåˆ†é¡",o=i.division||"ãã®ä»–",r=i.title||s;t.has(a)||t.set(a,new Map),t.get(a).has(o)||t.get(a).set(o,new Map),t.get(a).get(o).has(r)||t.get(a).get(o).set(r,[]),t.get(a).get(o).get(r).push({...e,info:i}),this.photoData.set(`${a}|${o}`,{category:a,division:o,files:t.get(a).get(o)}),this.photoData.set(`${a}|${o}|${r}`,{category:a,division:o,title:r,files:t.get(a).get(o).get(r)})}),t.forEach((e,t)=>this.F.set(`PHOTO_${t}`,{key:`PHOTO_${t}`,name:t,folders:e,isPhoto:!0}))}categorizeOthrs(e){const t=new Map;e.forEach(e=>{const s=this.X.get(e.name)||this.X.get(e.name.toUpperCase())||this.X.get(e.name.toLowerCase());if(s){e.info=s;const i=s.folder||"ãã®ä»–";t.has(i)||t.set(i,[]),t.get(i).push(e)}}),t.forEach((e,t)=>{this.F.set(`OTHRS_${t}`,{key:`OTHRS_${t}`,name:t,files:e,baseType:"OTHRS"})})}categorizeNonPhoto(e,t){t.forEach(e=>{const t=this.X.get(e.name)||this.X.get(e.name.toUpperCase())||this.X.get(e.name.toLowerCase());t&&(e.info=t)}),this.F.set(e,{key:e,name:CFG.names[CFG.types.indexOf(e)],files:t,baseType:e})}buildTree(){const e=new Map;this.F.forEach((t,s)=>{const i=s.startsWith("PHOTO_")?"PHOTO":s.startsWith("OTHRS_")?"OTHRS":t.baseType||s;e.has(i)||e.set(i,{name:CFG.names[CFG.types.indexOf(i)]||i,folders:[]}),e.get(i).folders.push({key:s,folder:t})});let t="";e.forEach((e,s)=>{t+=`<div class="fg"><div class="ft">${e.name}</div>`,"PHOTO"===s?e.folders.forEach(({folder:e})=>{const s=e.key.split("_")[1];t+=`<div class="f" onclick="v.showFolder('${e.key}',this)"><div class="fi"><span class="fn">${e.name}</span></div><span class="fc">${this.getTotalFiles(e.folders)}</span></div>`,e.folders.forEach((e,i)=>{const a=`${s}|${i}`;t+=`<div class="f sub" onclick="v.toggleDivision('${a}',this)" style="margin-left:20px"><div class="fi"><span class="fn">${i}</span></div><span class="fc">${this.getTotalFiles(e)}</span></div>`,e.forEach((e,s)=>{t+=`<div class="f title" onclick="v.showFiles('${a}|${s}',this)" style="margin-left:40px;display:none" data-division="${a}"><div class="fi"><span class="fn">${s}</span></div><span class="fc">${e.length}</span></div>`})})}):e.folders.forEach(({key:e,folder:s})=>t+=`<div class="f" onclick="v.showFolder('${e}',this)"><div class="fi"><span class="fn">${s.name}</span></div><span class="fc">${s.files.length}</span></div>`),t+="</div>"}),$("t").innerHTML=t}getTotalFiles(e){return e instanceof Map?Array.from(e.values()).reduce((e,t)=>e+(Array.isArray(t)?t.length:this.getTotalFiles(t)),0):e.length||0}toggleDivision(e,t){const s=this.E.has(e);document.querySelectorAll(".f.ac").forEach(e=>e.classList.remove("ac")),s?(this.E.delete(e),document.querySelectorAll(`[data-division="${e}"]`).forEach(e=>e.style.display="none")):(this.E.add(e),document.querySelectorAll(`[data-division="${e}"]`).forEach(e=>e.style.display="block"),t.classList.add("ac"))}showFiles(e,t){document.querySelectorAll(".f.ac").forEach(e=>e.classList.remove("ac")),t.classList.add("ac");const s=this.photoData.get(e);if(!s)return;const i=s.files;$("h2").textContent=`${s.title} (${i.length})`,this.P=i;let a='<div class="pg">';i.forEach((e,t)=>{const s=this.getURL(e.file);a+=`<div class="pi" onclick="v.openPhoto(${t})"><img class="pt" src="${s}" alt="${e.info.title}" loading="lazy"><div class="pf"><div class="pn">${e.info.title}</div><div class="pd">${e.info.date||""}</div></div></div>`}),a+="</div>",$("g").innerHTML=a}showFolder(e,t){document.querySelectorAll(".f.ac").forEach(e=>e.classList.remove("ac")),t.classList.add("ac");const s=this.F.get(e);if(s)if(s.isPhoto){const e=[];s.folders.forEach(t=>t.forEach(t=>t.forEach(t=>e.push(t)))),$("h2").textContent=`${s.name} (${e.length})`,this.P=e;let t='<div class="pg">';e.forEach((e,s)=>{const i=this.getURL(e.file);t+=`<div class="pi" onclick="v.openPhoto(${s})"><img class="pt" src="${i}" alt="${e.info.title}" loading="lazy"><div class="pf"><div class="pn">${e.info.title}</div><div class="pd">${e.info.date||""}</div></div></div>`}),t+="</div>",$("g").innerHTML=t}else{$("h2").textContent=`${s.name} (${s.files.length})`;const e=new Map;s.files.forEach(t=>{const s=t.info||{},i=s.title||"æœªåˆ†é¡";e.has(i)||e.set(i,{title:i,date:s.date||"",files:[]}),e.get(i).files.push(t)});const t=Array.from(e.values()).sort((e,t)=>e.title.localeCompare(t.title));let i='<div class="tb"><table class="tbl"><thead><tr><th>æ—¥ä»˜</th><th>ã‚¿ã‚¤ãƒˆãƒ«</th><th>ãƒ•ã‚¡ã‚¤ãƒ«</th></tr></thead><tbody>';t.forEach(e=>{i+=`<tr><td>${e.date}</td><td>${e.title}</td><td>`,e.files.forEach((e,t)=>{const s=e.info?.japaneseName||e.name;t>0&&(i+="<br>"),i+=`<span class="fl" onclick="v.openFile('${e.path}')">${s}</span>`}),i+="</td></tr>"}),i+="</tbody></table></div>",$("g").innerHTML=i}}updateProjectHeader(){if(!this.R)return;const{name:e,type:t,content:s,startDate:i,endDate:a,contractor:o}=this.R,r=[];if(e&&r.push(e),t&&r.push(t),s&&r.push(s.replace(/ã€€/g,"")),(i||a)&&r.push((i||"")+(i&&a?"ï½":"")+(a||"")),o&&r.push(o),r.length){let e=$("project-info");e||(e=document.createElement("div"),e.id="project-info",$("h").appendChild(e)),e.innerHTML=r.join("<br>")}}getURL(e){return this.U.has(e)||this.U.set(e,URL.createObjectURL(e)),this.U.get(e)}openPhoto(e){if(e<0||e>=this.P.length)return;this.I=e;const t=this.P[e],s=t.info;$("mi").src=this.getURL(t.file);const i=$("mo"),a=i.querySelector(".mc");a.classList.add("photo-modal");let o=`<div class="mt">${s.title}</div>`;s&&(o+=`<div class="ig"><div class="il">ç•ªå·</div><div class="iv">${s.serial||"ãªã—"}</div></div>\n             <div class="ig"><div class="il">ãƒ•ã‚¡ã‚¤ãƒ«å</div><div class="iv">${s.filename}</div></div>\n             <div class="ig"><div class="il">æ’®å½±æ—¥</div><div class="iv">${s.date||"ä¸æ˜"}</div></div>\n             <div class="ig"><div class="il">ãƒ¡ãƒ‡ã‚£ã‚¢</div><div class="iv">${s.media||"ãªã—"}</div></div>`,s.representative&&(o+='<span class="ba rep">â˜… ä»£è¡¨</span>'),s.frequency&&(o+='<span class="ba freq">âš¡ é »åº¦</span>'));let r=i.querySelector(".photo-info");r||(r=document.createElement("div"),r.className="photo-info",a.appendChild(r)),r.innerHTML=o;const n=document.querySelector(".mn"),[l,c]=n.children;l.disabled=e<=0,c.disabled=e>=this.P.length-1,i.classList.add("sh")}prevPhoto(){this.I>0&&this.openPhoto(this.I-1)}nextPhoto(){this.I<this.P.length-1&&this.openPhoto(this.I+1)}openFile(e){try{const t=this.M.get(e);if(!t)return void this.error("ãƒ•ã‚¡ã‚¤ãƒ«æœªæ¤œå‡º");const s=this.getURL(t),i=window.open();i?i.location.href=s:this.error("ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãƒ–ãƒ­ãƒƒã‚¯")}catch(e){this.error("ãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼")}}closeModal(e){if(e?.target.closest(".mc"))return;const t=$("mo");t.classList.remove("sh"),t.querySelector(".mc").classList.remove("photo-modal");const s=t.querySelector(".photo-info");s&&s.remove()}progress(e,t){$("p").style.display="block";const s=$("pb");s.style.width=e+"%",s.textContent=t}hideProgress(){$("p").style.display="none"}error(e){const t=document.createElement("div");t.className="al er",t.textContent=e,$("g").appendChild(t),setTimeout(()=>t.remove(),3e3)}clear(){this.U.forEach(e=>URL.revokeObjectURL(e)),this.M.clear(),this.X.clear(),this.F.clear(),this.U.clear(),this.P=[],this.I=0,this.R=null,this.E.clear(),this.photoData=new Map;const e=$("project-info");e&&e.remove()}reset(){this.clear(),$("t").innerHTML="",$("t").style.display="none",$("u").style.display="block",$("g").innerHTML='<div class="em">é¸æŠã§ãƒ•ã‚¡ã‚¤ãƒ«è¡¨ç¤º</div>',$("h2").textContent="ã‚«ãƒ†ã‚´ãƒªé¸æŠ",$("i").value="",this.hideProgress(),$("hs").textContent="æº–å‚™å®Œäº†"}}document.addEventListener("DOMContentLoaded",()=>window.v=new XMLViewer);